# QQ经典农场助手 - 需求规格书

## 1. 项目概述

将现有的命令行 QQ 经典农场挂机脚本，升级为带 Web 管理界面的 Electron 桌面应用。

### 1.1 目标用户

- 个人使用，单账号管理

### 1.2 使用场景

- 在公司电脑 7x24 小时长期运行
- 本地访问管理界面（localhost）
- 最终打包为 exe 可执行文件

## 2. 核心功能清单

### P0 - 必须实现

| 编号 | 功能 | 描述 |
|------|------|------|
| F01 | 登录管理 | 支持手动输入 code 登录；显示登录状态（在线/离线/code过期）；支持重新输入 code 重连 |
| F02 | 农场状态看板 | 实时显示：昵称、等级、经验进度条、金币；土地状态总览（生长中/可收获/空地/枯死）；当前种植的作物信息 |
| F03 | 操作日志 | 实时滚动显示所有操作日志（收获、种植、除草、偷菜等），替代原来的终端输出 |
| F04 | 功能开关 | 可独立开关的功能模块：自动收获、自动种植、自动施肥、自动除草、自动除虫、自动浇水、自动偷菜、好友巡查、自动领取任务 |
| F05 | 最优种植策略 | 根据用户当前等级可解锁的作物，自动计算「经验/小时」最高的作物并推荐；脚本 24h 运行，只需考虑单位时间最优 |
| F06 | 系统托盘 | 最小化到系统托盘后台运行，不占用任务栏 |

### P1 - 重要功能

| 编号 | 功能 | 描述 |
|------|------|------|
| F07 | 参数配置 | 可在页面调整：农场巡查间隔、好友巡查间隔、种植作物选择（手动指定或自动最优）|
| F08 | 好友列表 | 显示好友列表及最近偷菜/帮忙记录 |
| F09 | 断线重连 | code 过期或网络断开时，界面提示并支持快速重新输入 code |
| F10 | 配置持久化 | 功能开关、参数配置保存到本地文件，重启后恢复 |

### P2 - 锦上添花

| 编号 | 功能 | 描述 |
|------|------|------|
| F11 | 收益统计 | 统计今日/累计：收获次数、获得经验、获得金币、偷菜次数 |
| F12 | 内置抓包代理 | 内置 MITM 代理自动捕获 code（后续迭代） |

## 3. 业务规则与约束

### 3.1 种植策略计算规则

- 计算公式：`经验效率 = (收获经验 + 铲除经验) / (生长时间 - 肥料加速时间 + 操作时间)`
- 只计算用户当前等级已解锁且可购买的种子
- 普通肥料加速 30 秒
- 操作时间（购买+种植+施肥）约 15 秒
- 脚本 24h 运行，选择「经验/秒」最高的作物即可

### 3.2 现有功能保持不变

- 所有现有的农场操作逻辑（收获、种植、除草、除虫、浇水、施肥、偷菜、任务领取）保持原有行为
- WebSocket 通信协议、Protobuf 编解码不做修改
- 心跳保活机制不变

### 3.3 技术约束

- 基于现有 Node.js 项目改造，不重写
- Electron 桌面应用，前端 Vue 3 + TypeScript + Element Plus
- 打包工具 electron-builder，输出 Windows exe
- 仅本地访问（localhost）

## 4. 非功能需求

| 项目 | 要求 |
|------|------|
| 性能 | 界面操作不影响后台挂机逻辑的稳定性 |
| 稳定性 | 支持 7x24 小时长期运行不崩溃 |
| 可维护性 | 前后端分离，后台逻辑与 UI 解耦，方便后续迭代 |
